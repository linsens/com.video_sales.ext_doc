# Настройка системы лояльности

* [Получение правил списания бонусов](#Получение-правил-списания-бонусов)
* [Получение настроек системы лояльности](#Получение-настроек-системы-лояльности)
* [Обновление настроек системы лояльности](#Обновление-настроек-системы-лояльности)
* [Получение контактной информации для системы лояльности](#Получение-контактной-информации-для-системы-лояльности)
* [Обновление контактной информации для системы лояльности](#Обновление-контактной-информации-для-системы-лояльности)
* [Загрузка логотипа для системы лояльности](#Загрузка-логотипа-для-системы-лояльности)
* [Удаление логотипа для системы лояльности](#Удаление-логотипа-для-системы-лояльности)
* [Получение списка точек продажи](#Получение-списка-точек-продажи)
* [Обновление списка точек продажи](#Обновление-списка-точек-продажи)
* [Получение списка купонов](#Получение-списка-купонов)
* [Получение купона](#Получение-купона)
* [Добавление купона](#Добавление-купона)
* [Изменение купона](#Удаление-купона)
* [Загрузка изображения к купону](#Загрузка-изображения-к-купону)
* [Удаление изображения купона](#Удаление-изображения-купона)


## Получение правил списания бонусов
* **URL**

`/ext/api/v1/loyalty/settings/write_off/rules/`

* **Метод**

`GET`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
{
    "patterns": [{
        "currency" : "points",
        "amount" : 10.50
    } , {
        "currency" : "points",
        "amount" : 12.50
    }]
}
```

* **Описание параметров ответа**

Название поля | Описание
------------- | --------
currency | "Валюта" points, rubles
amount | Сумма списания


## Получение настроек системы лояльности
* **URL**

`/ext/api/v1/loyalty/settings/`

* **Метод**

`GET`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
{
    "active": true,
    "currency" : "points",
    "newCustomerSettings": {
        "couponId": 1,
        "type": "amount",
        "amount": 100,
        "validDays": null
    },
    "customerSettings": {
        "couponId": null,
        "type": "percentage",
        "amount": 10,
        "validDays": 30
    }
}
```

* **Описание параметров ответа**

Название поля | Описание
------------- | --------
active | true, false. Включена ли система лояльности
currency | Валюта бонусного счета. points, rubles.
newCustomerSettings | Описывает настройки для первой покупки
customerSettings | Описывает настройки для всех покупок, кроме первой
couponId | Идентификатор купона, который необходимо выдавать при покупке. Опциональный параметр.
type | amount - начисляется фиксированная сумма, которая указана в пол amount, percentage - начисляется процент от суммы заказа
amount | фиксированная сумма или процент в зависимости от поля type. Опциональный параметр.
validDays | кол-во дней после которого начисленный кэшбек сгорит, если им не воспользовались. Опциональный параметр.

## Обновление настроек системы лояльности
* **URL**

`/ext/api/v1/loyalty/settings/`

* **Метод**

`PUT`

* **URL параметры**

Отсутствуют

* **Параметры данных**

```json
{
    "active": true,
    "currency" : "points",
    "newCustomerSettings": {
        "couponId": 1,
        "type": "amount",
        "amount": 100,
        "validDays": null
    },
    "customerSettings": {
        "couponId": null,
        "type": "percentage",
        "amount": 10,
        "validDays": 30
    }
}
```

* **Описание параметров запроса**

Название поля | Описание
------------- | --------
active | true, false. Включена ли система лояльности
currency | Валюта бонусного счета. points, rubles.
newCustomerSettings | Описывает настройки для первой покупки
customerSettings | Описывает настройки для всех покупок, кроме первой
couponId | Идентификатор купона, который необходимо выдавать при покупке. Опциональный параметр.
type | amount - начисляется фиксированная сумма, которая указана в пол amount, percentage - начисляется процент от суммы заказа
amount | фиксированная сумма или процент в зависимости от поля type. Опциональный параметр.
validDays | кол-во дней после которого начисленный кэшбек сгорит, если им не воспользовались. Опциональный параметр.

* **Пример ответа**
 
200 OK

## Получение контактной информации для системы лояльности
* **URL**

`/ext/api/v1/loyalty/settings/contact_info/`

* **Метод**

`GET`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
{
    "company": "Рога и Копыта",
    "phone": "+7 (912) 345-67-89",
    "email": "test@test.ru",
    "url": "https://test.ru",
    "instagram": "https://instagram.com/test/",
    "facebook": "https://facebook.com",
    "vk": "https://vk.com",
    "youtube": "https://youtube.com",
    "logoPath": "https://i-bonus.me/path/"
}
```
 
* **Описание параметров ответа**

Название поля | Описание
------------- | --------
company | Название компании. Опциональный параметр.
phone | Номер телефона. Опциональный параметр.
email | Email. Опциональный параметр.
url | URL. Опциональный параметр.
instagram | Ссылка на Instagram. Опциональный параметр.
facebook | Ссылка на Facebook. Опциональный параметр.
vk | Ссылка на VK. Опциональный параметр.
youtube | Ссылка на YouTube. Опциональный параметр.
logoPath | Ссылка на загруженный логотип. Опциональный параметр.

## Обновление контактной информации для системы лояльности
* **URL**

`/ext/api/v1/loyalty/settings/contact_info/`

* **Метод**

`PUT`

* **URL параметры**

Отсутствуют

* **Параметры данных**

```json
{
    "company": "Рога и Копыта",
    "phone": "+7 (912) 345-67-89",
    "email": "test@test.ru",
    "url": "https://test.ru",
    "instagram": "https://instagram.com/test/",
    "facebook": "https://facebook.com",
    "vk": "https://vk.com",
    "youtube": "https://youtube.com"
}
```

* **Описание параметров запроса**

Название поля | Описание
------------- | --------
company | Название компании. Опциональный параметр.
phone | Номер телефона. Опциональный параметр.
email | Email. Опциональный параметр.
url | URL. Опциональный параметр.
instagram | Ссылка на Instagram. Опциональный параметр.
facebook | Ссылка на Facebook. Опциональный параметр.
vk | Ссылка на VK. Опциональный параметр.
youtube | Ссылка на YouTube. Опциональный параметр.

* **Пример ответа**

200 OK

## Загрузка логотипа для системы лояльности
* **URL**

`/ext/api/v1/loyalty/settings/contact_info/logo/`

* **Метод**

`POST` Multipart

* **URL параметры**

Отсутствуют

* **Параметры данных**

logo - файл с логотипом

* **Пример ответа**

200 OK

## Удаление логотипа для системы лояльности
* **URL**

`/ext/api/v1/loyalty/settings/contact_info/logo/`

* **Метод**

`DELETE`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

200 OK

## Получение списка точек продажи
* **URL**

`/ext/api/v1/loyalty/settings/sale_points/`

* **Метод**

`GET`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
[{
  "id": 1,
  "region": "МО",
  "city": "Москва",
  "address": "ул. Тверская, д. 1",
  "phone": "+ 7 (123) 456-78-90"
}, {
  "id": 2,
  "region": "МО",
  "city": "Москва",
  "address": "ул. Тверская, д. 3",
  "phone": "+ 7 (123) 456-78-90"
}]
```

* **Описание полей ответа**

Название поля | Описание
------------- | --------
id | Идентификаатор точки внутри системы
region | Регион. Опциональный параметр.
city | Город. Опциональный параметр.
address | Адрес. Опциональный параметр.
phone | Номер телефона. Опциональный параметр.

## Обновление списка точек продажи
* **URL**

`/ext/api/v1/loyalty/settings/sale_points/`

* **Метод**

`PUT`

* **URL параметры**

Отсутствуют

* **Параметры данных**

```json
[{
  "id": 1,
  "region": "МО",
  "city": "Москва",
  "address": "ул. Тверская, д. 1",
  "phone": "+ 7 (123) 456-78-90"
}, {
  "id": 2,
  "region": "МО",
  "city": "Москва",
  "address": "ул. Тверская, д. 3",
  "phone": "+ 7 (123) 456-78-90"
}]
```

* **Описание полей запроса**

Название поля | Описание
------------- | --------
id | Если передан, то все поля точки с этим id будут изменены, если не указать id, то запись будет траактоваться как новая и будет сохранена.
region | Регион. Опциональный параметр.
city | Город. Опциональный параметр.
address | Адрес. Опциональный параметр.
phone | Номер телефона. Опциональный параметр.

Если какая-то существующая точка не будет указано в теле запроса, то она будет удалена.

* **Пример ответа**

200 OK

## Получение списка купонов
* **URL**

`/ext/api/v1/loyalty/coupons/`

* **Метод**

`GET`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
[{
  "id": 1,
  "title": "Служебный заголовок",
  "header": "Заголовок",
  "subHeader": "Вторая строка заголовка",
  "shortDescription": "Первая часть описани",
  "longDescription": "Вторая часть описания",
  "imagePath": "https://i-bonus.me/cover/coupons/path.png",
  "style": "theme_brown",
  "validDays": 30,
  "validUntil": 1548968400000,
  "deleted": false
}]
```

* **Описание полей ответа**

Название поля | Описание
------------- | --------
id | Идентификатор внутри системы.
title | Служебынй заголовок. Опциональный параметр.
header | Заголовок. Опциональный параметр.
subHeader | Подзаголовок. Опциональный параметр.
shortDescription | Первая часть описания. Опциональный параметр.
longDescription | Вторая часть описания. Опциональный параметр.
imagePath | Путь до изображения. Опциональный параметр.
style | theme_pale_orange, theme_white, theme_light_blue, theme_brown, theme_soft_orange, theme_dark_grayish_navy, theme_black, theme_dull_green, theme_light_pink. По-умолчанию theme_brown. 
validDays | Кол-во дней сколько валиден купон после получения клиентов. Опциональный параметр.
validUntil | timestamp до какого времени купон в принципе доступен. Опциональный параметр.
deleted | true, false. Удален ли купон.


## Получение купона
* **URL**

`/ext/api/v1/loyalty/coupons/{id}/`

* **Метод**

`GET`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | идентификатор купона

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
{
  "id": 1,
  "title": "Служебный заголовок",
  "header": "Заголовок",
  "subHeader": "Вторая строка заголовка",
  "shortDescription": "Первая часть описани",
  "longDescription": "Вторая часть описания",
  "imagePath": "https://i-bonus.me/cover/coupons/path.png",
  "style": "theme_brown",
  "validDays": 30,
  "validUntil": 1548968400000,
  "deleted": false
}
```

* **Описание полей ответа**

Название поля | Описание
------------- | --------
id | Идентификатор внутри системы.
title | Служебынй заголовок. Опциональный параметр.
header | Заголовок. Опциональный параметр.
subHeader | Подзаголовок. Опциональный параметр.
shortDescription | Первая часть описания. Опциональный параметр.
longDescription | Вторая часть описания. Опциональный параметр.
imagePath | Путь до изображения. Опциональный параметр.
style | theme_pale_orange, theme_white, theme_light_blue, theme_brown, theme_soft_orange, theme_dark_grayish_navy, theme_black, theme_dull_green, theme_light_pink. По-умолчанию theme_brown. 
validDays | Кол-во дней сколько валиден купон после получения клиентов. Опциональный параметр.
validUntil | timestamp до какого времени купон в принципе доступен. Опциональный параметр.
deleted | true, false. Удален ли купон.

## Добавление купона
* **URL**

`/ext/api/v1/loyalty/coupons/`

* **Метод**

`POST`

* **URL параметры**

Отсутствуют

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
{
  "title": "Служебный заголовок",
  "header": "Заголовок",
  "subHeader": "Вторая строка заголовка",
  "shortDescription": "Первая часть описани",
  "longDescription": "Вторая часть описания",
  "style": "theme_brown",
  "validDays": 30,
  "validUntil": 1548968400000,
  "deleted": false
}
```

* **Описание полей ответа**

Название поля | Описание
------------- | --------
title | Служебынй заголовок. Опциональный параметр.
header | Заголовок. Опциональный параметр.
subHeader | Подзаголовок. Опциональный параметр.
shortDescription | Первая часть описания. Опциональный параметр.
longDescription | Вторая часть описания. Опциональный параметр.
style | theme_pale_orange, theme_white, theme_light_blue, theme_brown, theme_soft_orange, theme_dark_grayish_navy, theme_black, theme_dull_green, theme_light_pink. По-умолчанию theme_brown. 
validDays | Кол-во дней сколько валиден купон после получения клиентов. Опциональный параметр.
validUntil | timestamp до какого времени купон в принципе доступен. Опциональный параметр.
deleted | true, false. Удален ли купон.

## Изменение купона
* **URL**

`/ext/api/v1/loyalty/coupons/{id}/`

* **Метод**

`PUT`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор купона

* **Параметры данных**

```json
{
  "title": "Служебный заголовок",
  "header": "Заголовок",
  "subHeader": "Вторая строка заголовка",
  "shortDescription": "Первая часть описани",
  "longDescription": "Вторая часть описания",
  "style": "theme_brown",
  "validDays": 30,
  "validUntil": 1548968400000,
  "deleted": false
}
```

* **Описание полей ответа**

Название поля | Описание
------------- | --------
title | Служебынй заголовок. Опциональный параметр.
header | Заголовок. Опциональный параметр.
subHeader | Подзаголовок. Опциональный параметр.
shortDescription | Первая часть описания. Опциональный параметр.
longDescription | Вторая часть описания. Опциональный параметр.
style | theme_pale_orange, theme_white, theme_light_blue, theme_brown, theme_soft_orange, theme_dark_grayish_navy, theme_black, theme_dull_green, theme_light_pink. По-умолчанию theme_brown. 
validDays | Кол-во дней сколько валиден купон после получения клиентов. Опциональный параметр.
validUntil | timestamp до какого времени купон в принципе доступен. Опциональный параметр.
deleted | true, false. Удален ли купон.

* **Пример ответа**

200 OK

## Удаление купона
* **URL**

`/ext/api/v1/loyalty/coupons/{id}/`

* **Метод**

`DELETE`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор купона

* **Параметры данных**

Отсутствуют

* **Пример ответа**

200 OK

## Загрузка изображения к купону
* **URL**

`/ext/api/v1/loyalty/coupons/{id}/image/`

* **Метод**

`POST` Multipart

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор купона

* **Параметры данных**

image - файл с изображением

* **Пример ответа**

200 OK

## Удаление изображения купона
* **URL**

`/ext/api/v1/loyalty/coupons/{id}/image/`

* **Метод**

`DELETE`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор купона

* **Параметры данных**

Отсутствуют

* **Пример ответа**

200 OK