# Работа с клиентами

* [Получение клиентов](#Получение-клиентов)
* [Получение баланса клиента](#Получение-баланса-клиента)
* [Получение купонов клиента](#Получение-купонов-клиента)
* [Получение истории изменения баланса](#Получение-истории-изменения-баланса)
* [Списаниес клиента](#Списание-с-клиента)

## Получение клиентов
* **URL**

`/ext/api/v1/clients/`

* **Метод**

`GET`

* **URL параметры**

Название поля | Описание
------------- | --------
phone | Номер телефона. Часть передаваемой строки может быть заменена на %. Необязательный параметр.
email | Email клиента. Часть передаваемой строки может быть заменена на %. Необязательный параметр.

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
[{
    "id" : 1234567,
    "email" : "test@test.ru",
    "phone" : "7912345678",
    "name" : "Client First"
}]
     
```

* **Описание параметров ответа**

Название поля | Описание
------------- | --------
id | Идентификатор клиента
email | Email клиента. Может быть null
phone | Телефон клиента. Может быть null
name | Имя и фамилия клиента. Может быть null

## Получение баланса клиента
* **URL**

`/ext/api/v1/clients/{id}/balance/`

* **Метод**

`GET`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор клиента.

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
[{
    "amount" : 1234.56,
    "currency" : "points"
}, {
    "amount" : 4321.06,
    "currency" : "rubles"
}]
     
```

* **Описание параметров ответа**

Название поля | Описание
------------- | --------
amount | Сумма доступная для списания.
currency | Валюта. Пока только points и rubles.

## Получение купонов клиента
* **URL**

`/ext/api/v1/clients/{id}/coupons/`

* **Метод**

`GET`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор клиента.

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
[{
    "id" : 1234,
    "title" : "Описание купона",
    "expireDate": 1548968400000
}]
     
```

* **Описание параметров ответа**

Название поля | Описание
------------- | --------
id | Идентификатор купона.
title | Описание купона.
expireDate | Время по которое купон валиден.

## Получение истории изменения баланса
* **URL**

`/ext/api/v1/clients/{id}/balance/history/`

* **Метод**

`GET`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор клиента.
from | Timestamp. Время транзакции будет больше, либо равно переданному значению. Необязательный параметр.
to | Timestamp. Время транзакции будет меньше, либо равно переданному значению. Необязательный параметр.
offset | Число. Порядковый номер с которого будет произведена выдача(начинается с 0). Необязательный параметр.
limit | Число. Ограничение на кол-во записей в выдаче. Необязательный параметр.

* **Параметры данных**

Отсутствуют

* **Пример ответа**

```json
[{
    "amount" : 1234.56,
    "currency" : "points",
    "transactionDate" : 1548968400000,
    "transactionId" : "123456789"
}]
     
```

* **Описание параметров ответа**

Название поля | Описание
------------- | --------
amount | Сумма транзакции.
currency | Валюта транзакции. Пока только points и rubles.
transactionDate | Timestamp. Дата транзакции.
transactionId | Идентификатор транзакции.

## Списание с клиента
* **URL**

`/ext/api/v1/clients/{id}/balance/write_off/`

* **Метод**

`POST`

* **URL параметры**

Название поля | Описание
------------- | --------
{id} | Идентификатор клиента.

* **Параметры данных**

```json
{
    "balance": [{
        "amount" : 1234.56,
        "currency" : "points"
    }],
    "coupons" : [123, 321]
}
     
```

* **Описание параметров**

Название поля | Описание
------------- | --------
balance | Балансы с которых надо списать указанное количество. Может отсутствовать в запросе.
coupons | Купоны, которые необходимо погасить. Может отсутствовать в запросе.

* **Пример ответа**

200 OK

